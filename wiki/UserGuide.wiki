#summary ZTL user guide.
<wiki:toc max_depth="3" />

== Introduction ==
A ZTL file is a XML based format that is compiled by [http://zk-ztl.googlecode.com/svn/trunk/javadoc/org/zkoss/ztl/util/ZtlGenerator.html ZtlGenerator] to generate the Junit test case in Java.

For example (ZTL),
{{{
<test tags="button">
	<case id="Click">
		<server><!--
			<zk>
				<button id="btn" label="Click Me to Show a Message" onClick='alert("Hello!")'/>
			</zk>
		--></server>
		<client>
			click(btn);
			waitResponse();
			assertTrue(jq("@window").exists());
		</client>
	</case>
</test>
}}}
It will generate the Java class as follows:
{{{
/* B30_123456Test.java

	Purpose:
		
	Description:
		
	History:
		Mar, 29, 2010 15:52:29 PM

Copyright (C) 2010 Potix Corporation. All Rights Reserved.

This program is distributed under Apache License Version 2.0 in the hope that
it will be useful, but WITHOUT ANY WARRANTY.
*/
import org.junit.Test;
import org.zkoss.ztl.Element;
import org.zkoss.ztl.JQuery;
import org.zkoss.ztl.Tags;
import org.zkoss.ztl.Widget;
import org.zkoss.ztl.ZK;
import org.zkoss.ztl.ZKClientTestCase;

import com.thoughtworks.selenium.Selenium;

@Tags(tags = "button")
public class B30_123456Test extends ZKClientTestCase {
	
	public B30_123456Test() {
		target = "http://localhost:8080/zk50/service.zul";
		browsers = getBrowsers("all");
		_timeout = 60000;
	}
	
	@Test(expected = AssertionError.class)
	public void testClick() {
		for (Selenium browser : browsers) {
			boolean close = false;
			try {
				start(browser);
				browser.windowFocus();
				browser.windowMaximize();
				String zscript = "";
				Widget engine = new Widget(new StringBuffer("zk.Desktop._dt"));
				/** start **/
				/** server code **/
				zscript = ""
					+ "<zk>"
					+ "	<button id=\"btn\" label=\"Click Me to Show a Message\" onClick=\\'alert(\"Hello!\")\\'/>"
					+ "</zk>"
					+ ""
					;
				runZscript(zscript);
				Widget btn = engine.$f("btn");
				waitResponse();
				/** client code **/
				
				click(btn);
				waitResponse();
				assertTrue(jq("@window").exists());
				
				/** end **/
				close = true;
			} finally {
				if (close) stop();	
			}
		}
	}
}
}}}
== ZTL Description ==

=== Package ===
 The package of the test case is depended on where the file is located to the root directory. In this project, the directory is called *test*(you can use your own directory, please see [#Change_ZTL_directory this]).

 For example, the _B30-123456_ file is under _test/org/zkoss/zkdemo/test2/B30-123456.ztl_, its package is _org.zkoss.zkdemo.test2.B30_123456Test.java_, the dash sign '-' will replace with the underscore sign '`_`' for the legal Java class name convention.

=== File Name ===
 The file name of the ZTL file will convert to Java class name, so it should be a legal Java class name and Junit can recognize. i.e. The class name ends with *Test* postfix.

=== Test ===
 The root tag in the ZTL file can enclose one or many [#Case Case].
|| *Property* || *Description* || *Default Value* || *Require* ||
|| import || the package that require to import to this test case || none || optional ||
|| tags || the tags to filter the test case, like _button_, _window_, _listbox_, and so on. || none || optional ||
|| context-path || the name(zkdemo) of the context path, like http://localhost:8080/zkdemo || according to [http://zk-ztl.googlecode.com/svn/trunk/src/config.properties config.properties] || optional ||
|| server || the URL of the ZK server || according to [http://zk-ztl.googlecode.com/svn/trunk/src/config.properties config.properties] || optional ||
|| action || the path that is visited by Selenium server|| according to [http://zk-ztl.googlecode.com/svn/trunk/src/config.properties config.properties] || optional ||
|| delay || the delay time of each command run by Selenium ||according to [http://zk-ztl.googlecode.com/svn/trunk/src/config.properties config.properties] || optional ||
|| timeout || the timeout of the waiting response from zk server, in millisecond||according to [http://zk-ztl.googlecode.com/svn/trunk/src/config.properties config.properties] || optional ||
|| browser || the test case should be tested with all of the browser types ||according to [http://zk-ztl.googlecode.com/svn/trunk/src/config.properties config.properties] || optional ||

=== Case ===
 The tag is like a method of Junit test case, and each [#Case Case] in the same [#Test Test] won't impact each other. And it can enclose one or many [#Server Server] or [#Client Client]
|| *Property* || *Description* || *Default Value* || *Require* ||
|| id || the name of the method in the Junit test case that starts with "test" automatically || none || *yes* ||

=== Server ===
 The content of the tag is run at ZK server, and each tag will fire a Ajax request to execute the code.
|| *Property* || *Description* || *Default Value* || *Require* ||
|| id || the id of the server tag used for the *ref* property to identify. [http://zk-ztl.googlecode.com/svn/trunk/test/org/zkoss/zkdemo/test2/B30/B30-1486556.ztl For example]|| none || optional ||
|| ref || refer to the content of the server matched with the same id. i.e. the content of the tag will copy from the content of the server that id is matched. [http://zk-ztl.googlecode.com/svn/trunk/test/org/zkoss/zkdemo/test2/B30/B30-1486556.ztl For example]|| none || optional ||
|| lang || the content of the language like *Java*, *Ruby*, and so on.(allowed ZK support only) || zul || optional ||

=== Client ===
 The content of the tag is run at Selenium server.
|| *Property* || *Description* || *Default Value* || *Require* ||
|| wait || the delay time of the command inside the tag, in millisecond || none || optional ||

== Eclipse Project ==
=== Checkout Source Code ===
Please refer to [GetStartedWithZTL#Checkout_Source_Code]
=== Import an Existing Projects into Workspace ===
 # In your eclipse, click *File*>*Import...*>*Existing Projects into Workspace*
 # Select root directory with the *ztl* directory where you checkout
 # Right-click upon *`src/org/zkoss/ztl/util/ZtlGenerator.java`*, and click *Run As*>*Run Configurations...*
 # At the right panel of the dialog, click the tab *Arguments* and put the following arguments.
  {{{-src test -dist codegen}}}
 # Click *Apply* and *Run*
 # You can see all of the Junit test cases are created under the *codegen* directory.
 # Right-click upon the Junit test case you want to run as *Junit Test*

== Configure Ant Setting ==
=== Change ZTL directory ===
You can change the value of *test.src* under *ztl/build.prop.xml* to your own directory where the ZTL file are placed.